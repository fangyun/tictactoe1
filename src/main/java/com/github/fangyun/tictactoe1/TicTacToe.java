/**
 * GPL
 */
package com.github.fangyun.tictactoe1;

import java.util.HashMap;
import java.util.Map;

/**
 * @author FangYun
 *
 */
public class TicTacToe {
	private final static String[][] MAGIC_SQUARE = { { "X", "5", "1?", "2!", "8*", "6*" },
			{ "X", "5", "1?", "3!", "7*", "4! or 8!" }, { "v512", "5", "1?", "4!" },
			{ "X", "5", "1?", "6!", "4*", "2! or 7!" }, { "v513", "5", "1?", "7!" }, { "v516", "5", "1?", "8!" },
			{ "@", "5", "1?", "9?", "2!", "3", "7*", "6*", "4*" }, { "O", "5", "1?", "9?", "2!", "4?", "6*" },
			{ "@", "5", "1?", "9?", "2!", "6", "4*", "~" }, { "@", "5", "1?", "9?", "2!", "7", "3*", "~" },
			{ "@", "5", "1?", "9?", "2!", "8", "~" }, { "X", "5", "1?", "9?", "3?", "2!" },
			{ "v5192", "5", "1?", "9?", "4!" }, { "@", "5", "1?", "9?", "6!", "8*", "2*", "7*", "3*" },
			{ "v5193", "5", "1?", "9?", "7?" }, { "v5196", "5", "1?", "9?", "8!" },

			{ "@", "5", "2", "1", "9*", "4*", "6*", "7*", "3*" }, { "v512", "5", "2", "3" },
			{ "@", "5", "2", "4", "6*", "7", "3" }, { "v524", "5", "2", "6" },
			{ "@", "5", "2", "7", "3", "1", "9*", "4*", "6*" }, { "@", "5", "2", "7", "3", "4", "6*", "~" },
			{ "O", "5", "2", "7", "3", "6?", "4*" }, { "@", "5", "2", "7", "3", "8", "~" },
			{ "@", "5", "2", "7", "3", "9", "1*", "~" }, { "X", "5", "2", "8", "1?", "3 or 4" },
			{ "v5281", "5", "2", "8", "3?" }, { "@", "5", "2", "8", "4!", "9*", "1*", "~" },
			{ "v5284", "5", "2", "8", "6!" }, { "X", "5", "2", "8", "7?", "6*" }, { "v5287", "5", "2", "8", "9?" },
			{ "v527", "5", "2", "9" },

			{ "X", "6", "1?", "2!", "7", "4! or 5!" }, { "X", "6", "1?", "3?", "2?", "4! or 5!" },
			{ "X", "6", "1?", "3?", "4?", "7!" }, { "@", "6", "1?", "3?", "5!", "9*" },
			{ "X", "6", "1?", "3?", "7?", "4!" }, { "X", "6", "1?", "3?", "8?", "5! or 7!" },
			{ "X", "6", "1?", "3?", "9?", "5*" }, { "@", "6", "1?", "4?", "5*", "9", "2", "8" },
			{ "v516", "6", "1?", "5!" }, { "X", "6", "1?", "7!", "2*", "5!" }, { "@", "6", "1?", "8?", "5!!" },
			{ "@", "6", "1?", "9?", "2", "~" }, { "X", "6", "1?", "9?", "3?", "2! or 4!" },
			{ "@", "6", "1?", "9?", "4", "~" }, { "X", "6", "1?", "9?", "5?", "2!" },
			{ "X", "6", "1?", "9?", "7?", "4!" }, { "X", "6", "1?", "9?", "8?", "2! or 4!" },

			{ "X", "6", "2?", "1!", "8*", "5*" }, { "v6132", "6", "2?", "3", "1?" },
			{ "@", "6", "2?", "3", "4!", "9*", "1! or 5!" }, { "X", "6", "2?", "3", "5?", "8*" },
			{ "v6198", "6", "2?", "3", "7?" }, { "X", "6", "2?", "3", "8?", "5*" }, { "X", "6", "2?", "3", "9?", "4" },
			{ "X", "6", "2?", "4!", "5*", "8*" }, { "v524", "6", "2?", "5" }, { "v6172", "6", "2?", "7?", "1?" },
			{ "@", "6", "2?", "7?", "3", "4! or 8!" }, { "O", "6", "2?", "7?", "4!", "9*", "8!" },
			{ "@", "6", "2?", "7?", "5", "8*", "1*", "9*" }, { "X", "6", "2?", "7?", "8?", "5*" },
			{ "O", "6", "2?", "7?", "9!", "4*", "5*" }, { "X", "6", "2?", "8!", "1", "4!" },
			{ "v6192", "6", "2?", "9", "1" }, { "X", "6", "2?", "9", "3?", "1! or 5!" },
			{ "X", "6", "2?", "9", "4?", "1!" }, { "@", "6", "2?", "9", "5", "8*", "1*" },
			{ "X", "6", "2?", "9", "7?", "1! or 5!" }, { "X", "6", "2?", "9", "8?", "5*" },

			{ "O", "6", "3?", "1?", "8*", "4*", "5*" }, { "X", "6", "3?", "2!", "7", "5*" }, { "v614", "6", "3?", "4" },
			{ "v512", "6", "3?", "5!" }, { "O", "6", "3?", "7", "2", "1?", "8" },
			{ "@", "6", "3?", "7", "2", "4", "5*", "8*", "1*" }, { "@", "6", "3?", "7", "2", "5", "4*", "8*", "1*" },
			{ "@", "6", "3?", "7", "2", "8", "1*", "~" }, { "O", "6", "3?", "7", "2", "9?", "8!" },
			{ "v612", "6", "3?", "8!" }, { "v6193", "6", "3?", "9", "1?" }, { "v6293", "6", "3?", "9", "2?" },
			{ "X", "6", "3?", "9", "4?", "8*", "1*", "2!" }, { "@", "6", "3?", "9", "5", "7", "2*", "8*", "1*" },
			{ "v6139", "6", "3?", "9", "7?" }, { "v6239", "6", "3?", "9", "8?" },

			{ "O", "6", "4?", "1?", "8", "3", "2!" }, { "v628", "6", "4?", "2!" }, { "v6134", "6", "4?", "3", "1?" },
			{ "v6234", "6", "4?", "3", "2" }, { "@", "6", "4?", "3", "5", "~" }, { "@", "6", "4?", "3", "7", "~" },
			{ "X", "6", "4?", "3", "8?", "7" }, { "@", "6", "4?", "3", "9?", "2*", "7*", "8!" },
			{ "v641", "6", "4?", "7?" }, { "v628", "6", "4?", "8!" }, { "v643", "6", "4?", "9" },

			{ "v6275", "6", "5!", "1", "8*" }, { "v6185", "6", "5!", "2", "7" }, { "v6135", "6", "5!", "3", "1" },
			{ "v6235", "6", "5!", "3", "2?" }, { "v6435", "6", "5!", "3", "4" }, { "v6195", "6", "5!", "3", "7?" },
			{ "v6295", "6", "5!", "3", "8" }, { "v6395", "6", "5!", "3", "9" },
			{ "@", "6", "5!", "4", "1!", "9*", "2*", "8*", "3" }, { "X", "6", "5!", "4", "2?", "8*" },

			{ "v631", "7", "1?", "2?" }, { "O", "7", "1?", "3?", "5*", "9*", "6! or 8!" }, { "v639", "7", "1?", "4" },
			{ "v513", "7", "1?", "5!" }, { "v617", "7", "1?", "6!" }, { "v613", "7", "1?", "8" },
			{ "@", "7", "1?", "9", "2", "3", "5", "8", "4" }, { "O", "7", "1?", "9", "2", "4?", "8!" },
			{ "@", "7", "1?", "9", "2", "5", "3", "~" }, { "@", "7", "1?", "9", "2", "6", "3!", "4! or 5!" },
			{ "@", "7", "1?", "9", "2", "8", "3!", "4! or 5!" }, { "X", "7", "1?", "9", "3?", "2!" },
			{ "O", "7", "1?", "9", "4", "2?", "6*" }, { "@", "7", "1?", "9", "4", "3", "5*", "6*", "2*" },
			{ "@", "7", "1?", "9", "4", "5", "3*", "8*", "2*" }, { "@", "7", "1?", "9", "4", "6", "2", "~" },
			{ "@", "7", "1?", "9", "4", "8", "5! or 2!" }, { "X", "7", "1?", "9", "5?", "2!" },
			{ "X", "7", "1?", "9", "6?", "8*", "2", "3!" }, { "X", "7", "1?", "9", "6?", "8*", "3", "2!" },
			{ "X", "7", "1?", "9", "6?", "8*", "4", "5*" }, { "X", "7", "1?", "9", "6?", "8*", "5", "4*" },
			{ "X", "7", "1?", "9", "8?", "6*", "2*", "5*" },

			{ "v7194", "7", "2", "1?", "3" }, { "O", "7", "2", "1?", "4!", "9*", "5*" },
			{ "@", "7", "2", "1?", "5", "8*", "6*", "4*", "3*" }, { "X", "7", "2", "1?", "6?", "5!" },
			{ "X", "7", "2", "1?", "8?", "5" }, { "v7196", "7", "2", "1?", "9?" },
			{ "O", "7", "2", "3?", "5*", "8*", "4*" }, { "v629", "7", "2", "4" }, { "v527", "7", "2", "5" },
			{ "v627", "7", "2", "6?" }, { "v643", "7", "2", "8" }, { "v7192", "7", "2", "9", "1" },
			{ "X", "7", "2", "9", "4?", "5!" }, { "@", "7", "2", "9", "5", "8*", "~" },
			{ "X", "7", "2", "9", "8?", "5*" },

			{ "v719", "7", "3", "1" }, { "v637", "7", "3", "2" }, { "v619", "7", "3", "4" }, { "v519", "7", "3", "5" },

			{ "O", "7", "4?", "1?", "2!", "9*", "5*" }, { "X", "7", "4?", "1?", "3?", "8*", "6*", "5*" },
			{ "X", "7", "4?", "1?", "5?", "6*" }, { "X", "7", "4?", "1?", "6?", "5*" }, { "v621", "7", "4?", "2!" },
			{ "v723", "7", "4?", "3?" }, { "v521", "7", "4?", "5" }, { "v641", "7", "4?", "6?" },
			{ "v623", "7", "4?", "8" }, { "v721", "7", "4?", "9?" },

			{ "@", "7", "5", "1", "2", "8*", "6*", "4*", "3*" }, { "X", "7", "5", "1", "3?", "6!" },
			{ "X", "7", "5", "1", "4?", "6*" }, { "@", "7", "5", "1", "6", "4*" }, { "v6275", "7", "5", "2", "6" },
			{ "O", "7", "5", "3?", "1", "9", "6! or 8!" }, { "O", "7", "5", "3?", "2", "8*", "4*" },
			{ "v653", "7", "5", "4" } };

	private final static Map<Character, String> MAPPING = new HashMap<>();

	static {
		MAPPING.put('3', "震");
		MAPPING.put('4', "巽");
		MAPPING.put('9', "离");
		MAPPING.put('2', "坤");
		MAPPING.put('7', "兑");
		MAPPING.put('6', "乾");
		MAPPING.put('1', "坎");
		MAPPING.put('8', "艮");
		MAPPING.put('5', "中");
	}

	public String makePalace() {
		String end = " ";
		int len = end.length();
		StringBuilder sb = new StringBuilder();
		for (int i = 0; i < MAGIC_SQUARE.length; i++) {
			boolean hasPointerSymbol = false;
			for (int j = 0; j < MAGIC_SQUARE[i].length; j++) {
				String e = MAGIC_SQUARE[i][j];
				if (e.startsWith("v")) {
					break;
				}
				String conv = convert(e);
				sb.append(conv).append(end);
				hasPointerSymbol = true;
			}
			if (hasPointerSymbol) {
				sb.setLength(sb.length() - len);
				sb.append("\n");
			}
		}
		return sb.toString();
	}

	private String convert(String input) {
		char[] chs = input.toCharArray();
		StringBuilder sb = new StringBuilder();
		for (char ch : chs) {
			String v = MAPPING.get(ch);
			if (v != null) {
				sb.append(v);
			} else {
				if (ch == 'X' || ch == 'O' || ch == '@') {
					sb.append(ch);
				}
			}
		}
		return sb.toString();
	}
}
